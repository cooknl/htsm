<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Horizontal Time Safety Margin</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-188c8f7c4094ee37216073c4d8f06694.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="Horizontal Time Safety Margin">
<meta name="citation_author" content="Nathan Cook">
<meta name="citation_author" content="Jackson Cook">
<meta name="citation_language" content="en">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Horizontal Time Safety Margin</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Nathan Cook <a href="mailto:me@capncook.nl" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Niceville, FL
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Jackson Cook </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Niceville, FL
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="cook_horizontal_time_safety_margin_2025.pdf"><i class="bi bi-file-pdf"></i>PDF</a></p></div><div class="quarto-title-meta-contents"><p><a href="htsm-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-abstract" id="toc-sec-abstract" class="nav-link active" data-scroll-target="#sec-abstract">Abstract</a></li>
  <li><a href="#sec-acronyms" id="toc-sec-acronyms" class="nav-link" data-scroll-target="#sec-acronyms">Acronyms, Abbreviations, Symbols</a></li>
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link" data-scroll-target="#sec-intro"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#sec-tsm_origins" id="toc-sec-tsm_origins" class="nav-link" data-scroll-target="#sec-tsm_origins"><span class="header-section-number">2</span> Time Safety Margin Origins</a></li>
  <li><a href="#sec-taxi_margin" id="toc-sec-taxi_margin" class="nav-link" data-scroll-target="#sec-taxi_margin"><span class="header-section-number">3</span> Taxi Testing Requires Margins, Too</a></li>
  <li><a href="#sec-htsm_concept" id="toc-sec-htsm_concept" class="nav-link" data-scroll-target="#sec-htsm_concept"><span class="header-section-number">4</span> Horizontal Time Safety Margin Concept</a></li>
  <li><a href="#sec-htsm_implementation" id="toc-sec-htsm_implementation" class="nav-link" data-scroll-target="#sec-htsm_implementation"><span class="header-section-number">5</span> Horizontal Time Safety Margin Implementation</a>
  <ul class="collapse">
  <li><a href="#sec-calc_theta" id="toc-sec-calc_theta" class="nav-link" data-scroll-target="#sec-calc_theta"><span class="header-section-number">5.1</span> Calculating the Maximum Recoverable Crossing Angle, <span class="math inline">\(\theta\)</span></a></li>
  <li><a href="#sec-calc_remaining_params" id="toc-sec-calc_remaining_params" class="nav-link" data-scroll-target="#sec-calc_remaining_params"><span class="header-section-number">5.2</span> Calculating the Remaining Parameters</a></li>
  </ul></li>
  <li><a href="#sec-considerations" id="toc-sec-considerations" class="nav-link" data-scroll-target="#sec-considerations"><span class="header-section-number">6</span> Considerations</a>
  <ul class="collapse">
  <li><a href="#sec-consider_angle" id="toc-sec-consider_angle" class="nav-link" data-scroll-target="#sec-consider_angle"><span class="header-section-number">6.1</span> The Angle, <span class="math inline">\(\theta\)</span></a></li>
  <li><a href="#sec-consider_speed" id="toc-sec-consider_speed" class="nav-link" data-scroll-target="#sec-consider_speed"><span class="header-section-number">6.2</span> The Speed, <span class="math inline">\(s\)</span></a></li>
  <li><a href="#sec-consider_buffer" id="toc-sec-consider_buffer" class="nav-link" data-scroll-target="#sec-consider_buffer"><span class="header-section-number">6.3</span> The Buffer Distance, <span class="math inline">\(b\)</span></a></li>
  <li><a href="#sec-consider_radius" id="toc-sec-consider_radius" class="nav-link" data-scroll-target="#sec-consider_radius"><span class="header-section-number">6.4</span> The Turn Radius, <span class="math inline">\(r\)</span></a></li>
  <li><a href="#sec-consider_time" id="toc-sec-consider_time" class="nav-link" data-scroll-target="#sec-consider_time"><span class="header-section-number">6.5</span> The Time Margin, <span class="math inline">\(t\)</span></a></li>
  <li><a href="#sec-consider_interactions" id="toc-sec-consider_interactions" class="nav-link" data-scroll-target="#sec-consider_interactions"><span class="header-section-number">6.6</span> Parameter Interactions</a></li>
  <li><a href="#beyond-horizontal-time-safety-margin" id="toc-beyond-horizontal-time-safety-margin" class="nav-link" data-scroll-target="#beyond-horizontal-time-safety-margin"><span class="header-section-number">6.7</span> Beyond Horizontal Time Safety Margin</a></li>
  </ul></li>
  <li><a href="#sec-results" id="toc-sec-results" class="nav-link" data-scroll-target="#sec-results"><span class="header-section-number">7</span> Results During A Taxi Test Campaign</a></li>
  <li><a href="#sec-conclusions" id="toc-sec-conclusions" class="nav-link" data-scroll-target="#sec-conclusions"><span class="header-section-number">8</span> Conclusions</a></li>
  <li><a href="#sec-ack" id="toc-sec-ack" class="nav-link" data-scroll-target="#sec-ack">Acknowledgments</a></li>
  <li><a href="#sec-ref" id="toc-sec-ref" class="nav-link" data-scroll-target="#sec-ref">References</a></li>
  <li><a href="#sec-bio" id="toc-sec-bio" class="nav-link" data-scroll-target="#sec-bio">Biography</a></li>
  <li><a href="#sec-python" id="toc-sec-python" class="nav-link" data-scroll-target="#sec-python">Appendix A - Python Implementation</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<p>This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p>
<section id="sec-abstract" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-abstract">Abstract</h2>
<p>A technique is developed for establishing safety constraints during ground test directional maneuvering. The technique is applicable to any operation in an environment with hazards associated with departing a prepared surface or violating proximity buffers around personnel or property. The name “Horizontal Time Safety Margin” is inspired by the Time Safety Margin (TSM) approach to establishing abort criteria for highly dynamic vertical flight test maneuvering developed at Edwards AFB, honoring the legacy of David “Cools” Cooley. Previous TSM work is reviewed, and a general approach is provided to allow the specific constraints of any system under test to be factored into implementation. Considerations and lessons learned are discussed, based on recent taxi testing.</p>
</section>
<section id="sec-acronyms" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-acronyms">Acronyms, Abbreviations, Symbols</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Acronym</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>TSM</td>
<td>Time Safety Margin</td>
</tr>
<tr class="even">
<td>M&amp;S</td>
<td>Modeling and Simulation</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Prepared Surface Symbol</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(B\)</span></td>
<td>Distance buffer line</td>
</tr>
<tr class="even">
<td><span class="math inline">\(E\)</span></td>
<td>Edge of prepared surface</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(C\)</span></td>
<td>Centerline of prepared surface</td>
</tr>
<tr class="even">
<td><span class="math inline">\(w\)</span></td>
<td>Width between edges of prepared surface</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(o\)</span></td>
<td>Offset distance between centerline prepared surface and distance buffer line</td>
</tr>
<tr class="even">
<td><span class="math inline">\(h\)</span></td>
<td>Halfwidth distance from centerline to edge of prepared surface</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Horizontal Time Safety Margin Parameter</th>
<th>Definitions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(b\)</span></td>
<td>Buffer distance between distance buffer line and edge of prepared surface</td>
</tr>
<tr class="even">
<td><span class="math inline">\(s\)</span></td>
<td>Speed</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\theta\)</span></td>
<td>Crossing angle</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\theta_{abort}\)</span></td>
<td>Crossing angle value used as an abort criterion</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t_{margin}\)</span> or <span class="math inline">\(t\)</span></td>
<td>Time margin</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{turn_{recovery}}\)</span> or <span class="math inline">\(r\)</span></td>
<td>Turn radius during recovery</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Derived Parameter</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\vec{v}\)</span></td>
<td>Velocity vector</td>
</tr>
<tr class="even">
<td><span class="math inline">\(d_{margin}\)</span></td>
<td>Distance margin, the product of time margin and speed</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\dot{\theta}\)</span></td>
<td>Angular rate</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\ddot{\theta}\)</span></td>
<td>Angular acceleration</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\dot{s}\)</span></td>
<td>Linear acceleration</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Geometric Term</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Delta\)</span></td>
<td>Triangle</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\angle\)</span></td>
<td>Angle</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(I\)</span></td>
<td>Point of intersection of the ground path and <span class="math inline">\(B\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(T\)</span></td>
<td>Point where the recovery turn begins</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mu\)</span></td>
<td>Center of the turn circle</td>
</tr>
<tr class="even">
<td><span class="math inline">\(M\)</span></td>
<td>Point of intersection between <span class="math inline">\(B\)</span> and a line perpendicular to <span class="math inline">\(B\)</span> that runs through <span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x\)</span></td>
<td>Length of line segment from <span class="math inline">\(I\)</span> to <span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\alpha\)</span></td>
<td>Angle formed by <span class="math inline">\(\angle \mu IT\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H\)</span></td>
<td>Point of intersection between <span class="math inline">\(B\)</span> and a line perpendicular to <span class="math inline">\(B\)</span> that runs through <span class="math inline">\(T\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(F\)</span></td>
<td>Point where recovery turn is finished</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(V\)</span></td>
<td>Point of intersection between <span class="math inline">\(\overline{\mu F}\)</span> and a line perpendicular to <span class="math inline">\(\overline{\mu F}\)</span> that runs through <span class="math inline">\(T\)</span></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</section>
<section id="sec-intro" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="sec-intro"><span class="header-section-number">1</span> Introduction</h2>
<p>The primary hazard under consideration in this paper is “Departure from the Prepared Surface,” specifically in the context of low, medium, and high speed taxi test. Following established practice, a mitigation for this hazard is the establishment of abort criteria that allow for an abort procedure to provide recovery of the system under test before departing the prepared surface. The concept of horizontal time safety margin resulted deliberations on how to determine the abort criteria during taxi testing of new aircraft design as part of the build up to first flight.</p>
<p>The lack of quantitative means of determining abort criteria prompted a search for analogous methods that could inform the development of a quantitative approach. Time safety margin for vertical aerial maneuvering, developed to avoid collision with the surface, has many features in common with the problem of avoiding departing the prepared surface during horizontal ground maneuvering. Borrowing key elements from time safety margin, a horizontal analogy was implemented. The implementation is agnostic to any specific system and requires only basic kinematics for initial estimates. Higher-fidelity estimates can be generated by incorporating models of the system which include inertias and moments, if desired and available.</p>
</section>
<section id="sec-tsm_origins" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-tsm_origins"><span class="header-section-number">2</span> Time Safety Margin Origins</h2>
<p>The history and development of time safety margin is well covered by Bill “Evil” Gray in the 412th Test Wing Technical Information Handbook titled “Time Safety Margin: Theory And Practice.” <span class="citation" data-cites="Gray2016"><a href="#ref-Gray2016" role="doc-biblioref">[1]</a></span> Time safety margin was born out of the 2009 fatal mishap of Dave “Cools” Cooley during a diving test maneuver. The basic task of time safety margin is to determine the time an aircraft may remain on its worst-case vector until the planned recovery will no longer be sufficient to prevent a mishap. The necessity for the development of time safety margin was driven by large over- and under-estimations of maneuver setup and abort criteria. The techniques prior to time safety margin were often oversimplified and relied on imprecise or inaccurate assumptions. Over-estimates lead to excessive setup climbs and too-conservative abort calls, driving costs in time, fuel, and unnecessary repeated runs. Under-estimates lead to insufficient margin and an increase in risk exposure. After its incorporation into mandatory Air Force test processes, time safety margin has continued to evolve as exposure to multiple real-life scenarios has unveiled sensitivity to certain test conditions.</p>
<p><a href="#fig-basic-dive" class="quarto-xref">Figure&nbsp;1</a> shows the essential components necessary to understand and apply the time safety margin (TSM) concept. As defined in <span class="citation" data-cites="Gray2016"><a href="#ref-Gray2016" role="doc-biblioref">[1]</a></span>, a “maneuver” consists of a “procedure” and a “recovery.” In the figure, the procedure is simple upright pushover bunt dive, and the recovery is an upright pull until level. The “worst-case vector” in this case is the lowest altitude with the steepest angle relative to the ground. Extending the worst-case vector for a duration, the “time safety margin,” generates a straight line, the “TSM path,” that ends at the point where executing the remaining maneuver after the worst-case vector results in a “zero-spatial-margin” recovery not impacting the surface.</p>
<div id="fig-basic-dive" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Figure depicting the components of a basic dive recovery">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-dive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/tsm-theory-and-practice-fig-8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: From TSM Theory and Practice, Figure 8 “Basic Dive Recovery Terminology”"><img src="images/tsm-theory-and-practice-fig-8.png" class="img-fluid figure-img" style="width:80.0%" alt="Figure depicting the components of a basic dive recovery"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-dive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: From TSM Theory and Practice, Figure 8 “Basic Dive Recovery Terminology”
</figcaption>
</figure>
</div>
<p>The complexity of diving maneuvers makes closed-form solutions for determining test safety margin untenable, so even the simplest scenario with the :w most basic assumptions requires numerical methods to simulate the unfolding recovery. Any general approach must consider normal acceleration, true airspeed, Mach number, calibrated airspeed, dynamic pressure, initial aircraft attitude, recovery technique, asymmetric structural load, flight control system limiters, load alleviation systems, engine control system augmentation, and aircraft-specific factors. Time safety margin determination therefore necessitates a software solution, and the most common implementations have taken the form of MATLAB scripts and graphical user interfaces.</p>
</section>
<section id="sec-taxi_margin" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-taxi_margin"><span class="header-section-number">3</span> Taxi Testing Requires Margins, Too</h2>
<p>Taxi testing, consisting of ground maneuvers on prepared surfaces such as ramps, taxiways, and runways, may at first glance not seem as catastrophic in its consequences as diving at the ground. However, departure from the prepared surface can result in total destruction of an aircraft, loss of life, and destruction of adjacent property as much as high-speed impact with the ground after an unsuccessful dive recovery. Even minor damage or injury can set a test campaign back and lead to unacceptable losses in schedule, cost, publicity, or trust. So, while possibly not considered as dynamic or risky as aerial vertical maneuvering, ground horizontal maneuvering requires margin, too.</p>
<p>The simplest margin is a buffer along the edge of the prepared surface, providing a space-based abort criterion that can allow distance for a recovery maneuver to remain on the prepared surface. But how to determine the size of the buffer? What factors influence the balance between too much buffer and too little buffer? As with diving time safety margin, too much buffer leads to overly constrained maneuver and nuisance abort calls and too little buffer leads to no real mitigation of the hazard. Even before attempting to find that balance, a little further consideration shows that a distance buffer alone is insufficient.</p>
<p>The angle at which the aircraft crosses the buffer line greatly affects the ability to recover and remain on the prepared surface. Crossing the line at a right angle, heading directly toward the edge of the prepared surface, offers far less margin than crossing at a shallow angle. Therefore establishing a crossing angle that maintains margin for the recovery maneuver must also enter the balance. Too shallow an angle results in the same excessive margin as too large a distance buffer. Too large an angle results in the same insufficient margin as too small a distance buffer.</p>
<p>Intuitively, speed and turn radius also contribute to determining the margin. Speed reduces the time available for the operator to react, and can indirectly affect turn radius. Turn radius is constrained by forces. Skidding puts an upper limit on force available to turn. Structural load limits, the moment that initiates tipping, and shear induced on tires put an upper limit on force allowable to turn. Turning forces are also affected by surface conditions, tire wear, tire temperature, steering kinematics, and steering dynamics.</p>
</section>
<section id="sec-htsm_concept" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-htsm_concept"><span class="header-section-number">4</span> Horizontal Time Safety Margin Concept</h2>
<p>How then, to determine the appropriate values of distance buffer and crossing angle for a given speed and turn radius that result in a margin that strikes the balance? The principles of time safety margin can be brought to bear.</p>
<p>See <a href="#fig-basic-turn" class="quarto-xref">Figure&nbsp;2</a> for the concept depicted from an overhead view of a hypothetical runway. The figure is drawn to evoke geometry of <a href="#fig-basic-dive" class="quarto-xref">Figure&nbsp;1</a>, as this analogue was the original inspiration for the concept of a horizontal time safety margin. An aircraft is shown traveling from left to right, executing a right turn toward the edge of the runway, then recovering with a left turn with a smaller turn radius.<span class="citation" data-cites="AirplanePNG"><a href="#ref-AirplanePNG" role="doc-biblioref">[2]</a></span> The aircraft is not-to-scale and shown to assist in the visualization, but no actual aircraft characteristics or dynamics are assumed or depicted. Additionally, the aircraft is treated as a point mass for the purposes of this illustration without considering main gear wheelbase or nose gear geometry.</p>
<ol type="1">
<li>Distance buffer
<ul>
<li>The distance buffer is a line, <span class="math inline">\(B\)</span></li>
<li><span class="math inline">\(B\)</span> is parallel to the edge of the prepared surface, <span class="math inline">\(E\)</span></li>
<li><span class="math inline">\(B\)</span> is also offset from the centerline, <span class="math inline">\(C\)</span></li>
</ul></li>
<li>Recovery maneuver
<ul>
<li>The recovery maneuver is a turn</li>
<li>The turn is planned to begin at the moment of crossing the distance buffer line</li>
<li>The turn is planned to end when the velocity vector is parallel to the edge of the prepared surface and no longer at risk of departing</li>
</ul></li>
<li>Worst-case vector
<ul>
<li>The worst-case vector is the velocity vector, <span class="math inline">\(\vec{v}\)</span>, at the moment of crossing the distance buffer line, <span class="math inline">\(B\)</span></li>
<li>The vector consists of speed, <span class="math inline">\(s\)</span>, and direction, <span class="math inline">\(\theta\)</span>, the angle between the vector, <span class="math inline">\(\vec{v}\)</span> and the buffer line, <span class="math inline">\(B\)</span></li>
<li>The vector is not shown in <a href="#fig-basic-turn" class="quarto-xref">Figure&nbsp;2</a> to avoid cluttering the image</li>
</ul></li>
<li>Time margin
<ul>
<li>The time margin is a duration</li>
<li>The duration is the time for which the worst-case vector is extended prior to starting the recovery maneuver, shown as the dashed line in <a href="#fig-basic-turn" class="quarto-xref">Figure&nbsp;2</a>.</li>
</ul></li>
</ol>
<div id="fig-basic-turn" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Figure depicting the components of a basic turn recovery as inspired by TSM basic dive recovery">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-turn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaDiveCompare.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Basic Turn Recovery Inspired by TSM Basic Dive Recovery"><img src="images/BigIdeaDiveCompare.png" class="img-fluid figure-img" style="width:80.0%" alt="Figure depicting the components of a basic turn recovery as inspired by TSM basic dive recovery"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-turn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Basic Turn Recovery Inspired by TSM Basic Dive Recovery
</figcaption>
</figure>
</div>
</section>
<section id="sec-htsm_implementation" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sec-htsm_implementation"><span class="header-section-number">5</span> Horizontal Time Safety Margin Implementation</h2>
<p>To implement the concept, a more detailed look at the geometry is in order. Also, several additional simplifying assumptions are made for the initial implementation:</p>
<ol type="1">
<li>Constant speed during the full evolution</li>
<li>Circular turns with constant radii</li>
<li>Turn acceleration with no slip, skid, tip, or load exceedance</li>
<li>Symmetry for right and left turns</li>
<li>The speed and angle of the aircraft at the intersection of the ground path and the distance buffer line defines the worst-case vector, and therefore dynamics prior to the crossing can be ignored.</li>
</ol>
<p>With those assumptions in place, the following are given, as shown in <a href="#fig-given" class="quarto-xref">Figure&nbsp;3</a>:</p>
<ol type="1">
<li>a prepared surface with
<ol type="1">
<li>straight edge, <span class="math inline">\(E\)</span></li>
<li>a width, <span class="math inline">\(w\)</span></li>
<li>a center_line, <span class="math inline">\(C\)</span></li>
<li>a buffer line parallel to the edge of the prepared surface, <span class="math inline">\(B\)</span></li>
<li>a buffer distance, <span class="math inline">\(b\)</span>, from <span class="math inline">\(B\)</span> to <span class="math inline">\(E\)</span></li>
<li>an offset distance, <span class="math inline">\(o\)</span>, from <span class="math inline">\(C\)</span> to <span class="math inline">\(B\)</span></li>
<li>a halfwidth distance, <span class="math inline">\(h = \frac{w}{2}\)</span>, from <span class="math inline">\(C\)</span> to <span class="math inline">\(E\)</span></li>
</ol></li>
<li>a crossing vector, <span class="math inline">\(\vec{v}\)</span>, with magnitude, speed <span class="math inline">\(s\)</span>, and crossing angle <span class="math inline">\(\theta\)</span>
<ul>
<li>The assumed constant speed, <span class="math inline">\(s\)</span>, is depicted by showing the vector, <span class="math inline">\(\vec{v}\)</span> in three places
<ol type="1">
<li>With respect to the centerline, <span class="math inline">\(C\)</span>, with speed <span class="math inline">\(s\)</span> and angle <span class="math inline">\(\theta\)</span></li>
<li>With respect to the buffer line, <span class="math inline">\(B\)</span>, with speed <span class="math inline">\(s\)</span> and angle <span class="math inline">\(\theta\)</span></li>
<li>After full recovery, with speed <span class="math inline">\(s\)</span> and parallel to the edge, <span class="math inline">\(E\)</span></li>
</ol></li>
</ul></li>
<li>a desired time margin, <span class="math inline">\(t_{margin}\)</span></li>
<li>a turn radius, <span class="math inline">\(r_{turn_{recovery}}\)</span></li>
</ol>
<div id="fig-given" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Figure depicting the given parameters">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-given-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaStaticGiven.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: The given parameters for horizontal time safety margin"><img src="images/BigIdeaStaticGiven.png" class="img-fluid figure-img" style="width:80.0%" alt="Figure depicting the given parameters"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-given-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: The given parameters for horizontal time safety margin
</figcaption>
</figure>
</div>
<section id="sec-calc_theta" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="sec-calc_theta"><span class="header-section-number">5.1</span> Calculating the Maximum Recoverable Crossing Angle, <span class="math inline">\(\theta\)</span></h3>
<p>The goal is to calculate the maximum crossing angle, <span class="math inline">\(\theta\)</span>, that allows:</p>
<ol type="1">
<li>straight line travel for
<ol type="1">
<li>time, <span class="math inline">\(t_{margin}\)</span>, and</li>
<li>distance, <span class="math inline">\(d_{margin}\)</span>, where <span class="math inline">\(d_{margin} = t_{margin} \cdot s\)</span></li>
</ol></li>
<li>then a recovery with radius <span class="math inline">\(r_{turn_{recovery}}\)</span>,</li>
<li>that results in the vehicle moving parallel to <span class="math inline">\(E\)</span></li>
<li>without departing the prepared surface</li>
</ol>
<p><a href="#fig-calc-examples" class="quarto-xref">Figure&nbsp;4</a> shows three angles that do not meet the desired outcome for the given parameters. Speed, time margin, turn radius, runway dimensions, and buffer distance are the same for all three examples. One angle is too large for the given parameters. Perpendicular to the buffer line, it results in departure from the prepared surface. The other two are too small for the given parameters. While they both result in a safe recovery, they are too shallow for the time margin selected. The two shallow angles result in excessive margin and potentially nuisance abort calls.</p>
<div id="fig-calc-examples" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Figure depicting non-optimal angles for the given parameters">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-calc-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaStaticCalculate.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Three angles that result in insufficient margin or excessive margin for the given speed, buffer distance, turn radius and time margin"><img src="images/BigIdeaStaticCalculate.png" class="img-fluid figure-img" style="width:80.0%" alt="Figure depicting non-optimal angles for the given parameters"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calc-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Three angles that result in insufficient margin or excessive margin for the given speed, buffer distance, turn radius and time margin
</figcaption>
</figure>
</div>
<p>To more precisely state the geometry problem, <a href="#fig-angles" class="quarto-xref">Figure&nbsp;5</a> zooms in to the buffer distance, <span class="math inline">\(b\)</span>. The figure depicts the geometry for a recovery at the edge of the prepared surface after traveling a straight-line distance for the full duration of the time safety margin.</p>
<div id="fig-angles" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Figure depicting the angles necessary to determine the desired crossing angle">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-angles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaStaticAngles.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Analysis of the desired crossing angle"><img src="images/BigIdeaStaticAngles.png" class="img-fluid figure-img" style="width:80.0%" alt="Figure depicting the angles necessary to determine the desired crossing angle"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-angles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Analysis of the desired crossing angle
</figcaption>
</figure>
</div>
<p>Upon inspection, two right triangles, <span class="math inline">\(\Delta \mu IT\)</span> and <span class="math inline">\(\Delta I\mu M\)</span>, can be constructed from the following elements:</p>
<ul>
<li><span class="math inline">\(I\)</span>, the point of intersection between the ground path and the buffer line</li>
<li><span class="math inline">\(T\)</span>, the point where the recovery turn begins</li>
<li><span class="math inline">\(\mu\)</span>, the center of the turn circle</li>
<li><span class="math inline">\(M\)</span>, the point of intersection between the buffer line and a line perpendicular to the buffer line that runs through <span class="math inline">\(\mu\)</span></li>
</ul>
<p>The sides of the triangles can be related to the horizontal time safety margin parameters:</p>
<ul>
<li><span class="math inline">\(d_{margin}\)</span>, the length of line segment <span class="math inline">\(\overline{IT}\)</span></li>
<li><span class="math inline">\(r_{turn_{recovery}}\)</span>, the length of line segment <span class="math inline">\(\overline{T\mu}\)</span></li>
<li><span class="math inline">\(b - r_{turn_{recovery}}\)</span>, the length of line segment <span class="math inline">\(\overline{M\mu}\)</span></li>
</ul>
<p>The two triangles share a hypotenuse,<span class="math inline">\(\overline{I\mu}\)</span>, with length <span class="math inline">\(x\)</span>.</p>
<p><span class="math inline">\(\overline{I\mu}\)</span> divides the crossing angle, <span class="math inline">\(\theta\)</span> into two angles:</p>
<ul>
<li><span class="math inline">\(\alpha\)</span>, the angle formed by <span class="math inline">\(\angle \mu IT\)</span></li>
<li><span class="math inline">\(\theta - \alpha\)</span>, the angle formed by <span class="math inline">\(\angle MI\mu\)</span></li>
</ul>
<p>The angle <span class="math inline">\(\alpha\)</span> can be related to the horizontal time safety margin parameters using the <span class="math inline">\(\tan\)</span> of <span class="math inline">\(\Delta \mu IT\)</span>, as shown in <a href="#eq-alpha" class="quarto-xref">Equation&nbsp;1</a>.</p>
<p><span id="eq-alpha"><span class="math display">\[
\alpha = \tan^{-1} \left( \frac{r_{turn_{recovery}}}{d_{margin}} \right)
\tag{1}\]</span></span></p>
<p>The angle <span class="math inline">\(\theta - \alpha\)</span> can be related to the horizontal time safety margin parameters using the <span class="math inline">\(\sin\)</span> of <span class="math inline">\(\Delta I\mu M\)</span>, as shown in <a href="#eq-theta_alpha_x" class="quarto-xref">Equation&nbsp;2</a>.</p>
<p><span id="eq-theta_alpha_x"><span class="math display">\[
\theta - \alpha = \sin^{-1} \left( \frac{b - r_{turn_{recovery}}}{x}\right)
\tag{2}\]</span></span></p>
<p>Making use of the Pythagorean Theorem from <span class="math inline">\(\Delta \mu IT\)</span> defines <span class="math inline">\(x\)</span> in terms of <span class="math inline">\(r_{turn_{recovery}}\)</span> and <span class="math inline">\(d_{margin}\)</span>, as shown in <a href="#eq-theta_alpha" class="quarto-xref">Equation&nbsp;3</a>.</p>
<p><span id="eq-theta_alpha"><span class="math display">\[
\theta - \alpha = \sin^{-1} \left( \frac{b - r_{turn_{recovery}}}{\sqrt{{r_{turn_{recovery}}}^{2} + d_{margin}^{2}}} \right)
\tag{3}\]</span></span></p>
<p>When adding the two equations, <span class="math inline">\(\alpha\)</span> drops out and only <span class="math inline">\(\theta\)</span> remains, providing a closed-form solution for <span class="math inline">\(\theta\)</span>, <a href="#eq-theta" class="quarto-xref">Equation&nbsp;4</a>.</p>
<p><span id="eq-theta"><span class="math display">\[
\theta = \tan^{-1} \left( \frac{r_{turn_{recovery}}}{d_{margin}} \right) + \sin^{-1} \left( \frac{b - r_{turn_{recovery}}}{\sqrt{{r_{turn_{recovery}}}^{2} + d_{margin}^{2}}} \right)
\tag{4}\]</span></span></p>
<p>Substituting the speed, <span class="math inline">\(s\)</span>, and time margin, <span class="math inline">\(t_{margin}\)</span>, for the distance, <span class="math inline">\(d_{margin}\)</span>, provides an equation completely in terms of the horizontal time safety margin parameters, <a href="#eq-theta-full" class="quarto-xref">Equation&nbsp;5</a>.</p>
<p><span id="eq-theta-full"><span class="math display">\[
\theta = \tan^{-1} \left( \frac{r_{turn_{recovery}}}{t_{margin} \cdot s} \right) + \sin^{-1} \left( \frac{b - r_{turn_{recovery}}}{\sqrt{{r_{turn_{recovery}}}^{2} + \left(t_{margin} \cdot s\right)^{2}}} \right)
\tag{5}\]</span></span></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>This function provides the abort angle in radians, given that the distance, time, and speed units are consistent in length and time. As always, careful attention to unit conversions is necessary, especially when working in typical aviation units, when working across teams, and when working with international partners.</p>
</div>
</div>
<p><a href="#fig-perfect" class="quarto-xref">Figure&nbsp;6</a> provides an example of a geometry using the following values in normalized units as inputs:</p>
<ul>
<li><span class="math inline">\(b = 4.0\)</span>,</li>
<li><span class="math inline">\(r_{turn_{recovery}} = 1.0\)</span>,</li>
<li><span class="math inline">\(s = 1.0\)</span>, and</li>
<li><span class="math inline">\(t_{margin} = 4.0\)</span>.</li>
</ul>
<p>This results in an angle of <span class="math inline">\(\theta = 1.05981\mathrm{rad} = 60.7226^{\circ}\)</span> and recovery of a point mass without departing the prepared surface.</p>
<div id="fig-perfect" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A figure depicting the precision with which the angle calculated using the equation provides the desired outcome">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-perfect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaStaticCalculatePerfect.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Demonstration of use of Equation&nbsp;5 to achieve a 4.0 time safety margin"><img src="images/BigIdeaStaticCalculatePerfect.png" class="img-fluid figure-img" style="width:80.0%" alt="A figure depicting the precision with which the angle calculated using the equation provides the desired outcome"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-perfect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Demonstration of use of <a href="#eq-theta-full" class="quarto-xref">Equation&nbsp;5</a> to achieve a 4.0 time safety margin
</figcaption>
</figure>
</div>
</section>
<section id="sec-calc_remaining_params" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="sec-calc_remaining_params"><span class="header-section-number">5.2</span> Calculating the Remaining Parameters</h3>
<p>There may be scenarios in which the angle, <span class="math inline">\(\theta\)</span>, is already known or defined. There may also be sensitivity studies in which the effect of varying one parameter on the remaining parameters is of interest. In these scenarios or studies, determining the other parameters may be necessary to fully define or explore the trade space for the abort criteria.</p>
<p>With a slight shift in perspective, the other parameters can be determined, given a desired angle and the remaining parameters, as shown in <a href="#fig-others" class="quarto-xref">Figure&nbsp;7</a>. To declutter the figure:</p>
<ul>
<li>the turn radius, <span class="math inline">\(r_{turn_{recovery}}\)</span>, is shown as <span class="math inline">\(r\)</span>,</li>
<li>the time margin, <span class="math inline">\(t_{margin}\)</span>, is shown as <span class="math inline">\(t\)</span>, and</li>
<li>the time margin distance, <span class="math inline">\(d_{margin}\)</span>, is shown as the product <span class="math inline">\(t\cdot s\)</span> .</li>
</ul>
<div id="fig-others" class="quarto-float quarto-figure quarto-figure-center anchored" alt="A figure depicting a closed form solution for the other parameters">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/BigIdeaStaticOtherAngles.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: A shift in geometry yields a closed form solution for the other parameters, given the crossing angle, \theta"><img src="images/BigIdeaStaticOtherAngles.png" class="img-fluid figure-img" style="width:80.0%" alt="A figure depicting a closed form solution for the other parameters"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-others-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: A shift in geometry yields a closed form solution for the other parameters, given the crossing angle, <span class="math inline">\(\theta\)</span>
</figcaption>
</figure>
</div>
<section id="sec-triangle_tih" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="sec-triangle_tih"><span class="header-section-number">5.2.1</span> Triangle <span class="math inline">\(\Delta TIH\)</span></h4>
<p>A right triangle, <span class="math inline">\(\Delta TIH\)</span>, can be defined with</p>
<ul>
<li>vertices at points
<ul>
<li><span class="math inline">\(I\)</span>, where the ground path intersects the buffer line, <span class="math inline">\(B\)</span></li>
<li><span class="math inline">\(T\)</span>, where the turn recovery starts</li>
<li><span class="math inline">\(H\)</span>, the point of intersection between <span class="math inline">\(B\)</span> and a line perpendicular to <span class="math inline">\(B\)</span> that runs through <span class="math inline">\(T\)</span></li>
</ul></li>
<li>angle, <span class="math inline">\(\angle HIT\)</span>, which is also the crossing angle, <span class="math inline">\(\theta\)</span></li>
<li>hypotenuse, <span class="math inline">\(\overline{IT}\)</span>, which is also the time margin distance, <span class="math inline">\(d_{margin} = t \cdot s\)</span></li>
<li>side, <span class="math inline">\(\overline{HT}\)</span>, which is opposite <span class="math inline">\(\theta\)</span></li>
</ul>
<p><span id="eq-sin-theta-ht"><span class="math display">\[
\sin\theta = \frac{\overline{HT}}{\overline{IT}} = \frac{\overline{HT}}{t \cdot s}
\tag{6}\]</span></span></p>
<p><span class="math inline">\(\overline{HT}\)</span>, can be expressed in terms of <span class="math inline">\(r\)</span>, and <span class="math inline">\(b\)</span>, with the help of another triangle and line segment.</p>
</section>
<section id="sec-triangle_tmuv" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="sec-triangle_tmuv"><span class="header-section-number">5.2.2</span> Triangle <span class="math inline">\(\Delta T\mu V\)</span> and Line Segment <span class="math inline">\(\overline{M\mu}\)</span></h4>
<p>A right triangle, <span class="math inline">\(\Delta T\mu V\)</span>, can be defined with</p>
<ul>
<li>vertices at points
<ul>
<li><span class="math inline">\(\mu\)</span>, the center point of the turn circle</li>
<li><span class="math inline">\(T\)</span>, where the turn recovery starts</li>
<li><span class="math inline">\(V\)</span>,
<ul>
<li>on the line segment <span class="math inline">\(\overline{\mu F}\)</span></li>
<li><span class="math inline">\(F\)</span> is the point where the recovery turn is finished</li>
<li><span class="math inline">\(V\)</span> is the point of intersection between <span class="math inline">\(\overline{\mu F}\)</span> and a line perpendicular to <span class="math inline">\(\overline{\mu F}\)</span> that runs through <span class="math inline">\(T\)</span>|</li>
</ul></li>
</ul></li>
<li>angle, <span class="math inline">\(\angle T\mu V\)</span>, which is also the crossing angle, <span class="math inline">\(\theta\)</span></li>
<li>hypotenuse, <span class="math inline">\(\overline{\mu T}\)</span>, which is also the recovery turn radius, <span class="math inline">\(r\)</span></li>
<li>side, <span class="math inline">\(\overline{\mu V}\)</span>, which is adjacent to <span class="math inline">\(\theta\)</span>, and therefore <span class="math inline">\(\overline{\mu V} = r\cos\theta\)</span></li>
</ul>
<p>A line segment, <span class="math inline">\(\overline{M\mu}\)</span>, can be seen to be the difference between the buffer distance, <span class="math inline">\(b\)</span>, and the recovery turn radius, <span class="math inline">\(r\)</span>, thus <span class="math inline">\(\overline{M\mu} = b - r\)</span>.</p>
<p><span class="math inline">\(\overline{HT}\)</span> is equivalent to <span class="math inline">\(\overline{MV}\)</span>, the sum of <span class="math inline">\(\overline{M\mu}\)</span> and <span class="math inline">\(\overline{\mu V}\)</span>.</p>
<p>Therefore</p>
<p><span id="eq-ht"><span class="math display">\[
\begin{aligned}
\overline{HT} = \overline{MV} = &amp;&amp;&amp; \overline{M\mu} &amp; + &amp; \overline{\mu V}\\
= &amp;&amp;&amp; \left( b - r\right) &amp; + &amp; \left(r\cos\theta\right) \\
= &amp;&amp;&amp; b + r\left(\cos\theta - 1\right) &amp;&amp;
\end{aligned}
\tag{7}\]</span></span></p>
<p>Combining <a href="#eq-sin-theta-ht" class="quarto-xref">Equation&nbsp;6</a> and <a href="#eq-ht" class="quarto-xref">Equation&nbsp;7</a> gives,</p>
<p><span id="eq-all-params"><span class="math display">\[
\sin\theta = \frac{b + r \left(\cos\theta - 1 \right)}{t \cdot s}
\tag{8}\]</span></span></p>
<p><span class="math inline">\(\Delta TIH\)</span> relates all five of the parameters, as shown in <a href="#eq-all-params" class="quarto-xref">Equation&nbsp;8</a>, with <span class="math inline">\(\theta\)</span> the only parameter included twice.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>If <span class="math inline">\(\theta\)</span> is known, then, the other four parameters can each be solved simply in terms of the remaining parameters, as shown below.</p>
<p><span id="eq-time"><span class="math display">\[
t = \frac{b + r \left(\cos\theta - 1 \right)}{s\sin\theta}
\tag{9}\]</span></span></p>
<p><span id="eq-speed"><span class="math display">\[
s = \frac{b + r \left(\cos\theta - 1 \right)}{t\sin\theta}
\tag{10}\]</span></span></p>
<p><span id="eq-buffer"><span class="math display">\[
b = t \cdot s\sin\theta + r \left(1 - \cos\theta \right)
\tag{11}\]</span></span></p>
<p><span id="eq-radius"><span class="math display">\[
r = \frac{t \cdot s\sin\theta - b }{ \cos\theta -1 }
\tag{12}\]</span></span></p>
<p><a href="#eq-theta-full" class="quarto-xref">Equation&nbsp;5</a>, <a href="#eq-time" class="quarto-xref">Equation&nbsp;9</a>, <a href="#eq-speed" class="quarto-xref">Equation&nbsp;10</a>, <a href="#eq-buffer" class="quarto-xref">Equation&nbsp;11</a>, and <a href="#eq-radius" class="quarto-xref">Equation&nbsp;12</a> provide a complete description of how to determine the magnitudes of the buffer distance, <span class="math inline">\(b\)</span>, the time margin, <span class="math inline">\(t\)</span>, the speed, <span class="math inline">\(s\)</span>, the turn radius, <span class="math inline">\(r\)</span>, and the crossing angle, <span class="math inline">\(\theta\)</span>, that together provide an optimal recovery with no under- or overshooting during recovery.</p>
</section>
</section>
</section>
<section id="sec-considerations" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sec-considerations"><span class="header-section-number">6</span> Considerations</h2>
<p>The simplifying assumptions used to derive the equations above each have additional considerations that will affect the utility of the horizontal time safety margin concept. The section will address a few considerations for each. As ever, safety planning and safe execution rely on:</p>
<ul>
<li>sufficient knowledge of the system under test, including its capabilities, necessary constraints, and inherent margins,</li>
<li>the experience, training, currency, and proficiency of the test team in both system operation and test conduct,</li>
<li>test day conditions,</li>
<li>the regulatory and oversight systems in place for the planning and execution,</li>
<li>the time set aside for dedicated discussion, thought, and experimentation,</li>
<li>and the clarity, conciseness, correctness, and completeness of communication throughout planning and execution.</li>
</ul>
<p>As such, no single paper or presentation can suffice for all circumstances.</p>
<section id="sec-consider_angle" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="sec-consider_angle"><span class="header-section-number">6.1</span> The Angle, <span class="math inline">\(\theta\)</span></h3>
<section id="sec-consider_angle_defn" class="level4" data-number="6.1.1">
<h4 data-number="6.1.1" class="anchored" data-anchor-id="sec-consider_angle_defn"><span class="header-section-number">6.1.1</span> Angle Definition</h4>
<p>The direction of the diving time safety margin worst-case vector, <span class="math inline">\(\theta\)</span>, is treated in this paper as essentially the same as the angle at which the vehicle crosses the the buffer line. This can be seen as a somewhat circular, because the buffer line is, in part, established as resulting from the worst-case vector. Which comes first, the angle or the buffer? The decision to set the angle or the buffer distance first is somewhat arbitrary, but can be influenced by the specific test technique that is being employed and the test conditions that must be met for the results to be valid, as well as the nature of the prepared surface.</p>
</section>
<section id="sec-consider_angle_rate" class="level4" data-number="6.1.2">
<h4 data-number="6.1.2" class="anchored" data-anchor-id="sec-consider_angle_rate"><span class="header-section-number">6.1.2</span> Angular Rate, <span class="math inline">\(\dot{\theta}\)</span>, and Angular Acceleration, <span class="math inline">\(\ddot{\theta}\)</span></h4>
<p>The simplifying assumptions do not address angle rate at all, and in fact the entire treatment assumes a point mass. Angular momentum of a vehicle that is rotating toward the edge of the prepared surface must be negated and in fact reversed. This requires torque, which in turn requires reaction forces with the prepared surface, and which must be transferred from the surface, through the physical geometry of the vehicle. The extent and strength of any subcomponents and their connections to the vehicle can impose additional constraints on the rate and acceleration of the angle.</p>
<p>Additionally, the control system itself may have some constraint on the rate or acceleration, either due to operator inputs via inceptor design, control system logic via limiters or inherent properties, control system implementation via feedback or estimations, or effector characteristics such as flow rate limits, hardstops, or other nonlinearities.</p>
</section>
<section id="sec-consider_angle_prox" class="level4" data-number="6.1.3">
<h4 data-number="6.1.3" class="anchored" data-anchor-id="sec-consider_angle_prox"><span class="header-section-number">6.1.3</span> Proximity to the Centerline and the Edge</h4>
<p>Larger angles may be tolerated toward the center of the prepared surface than toward the edge. A single abort angle <span class="math inline">\(\theta_{abort}\)</span> is typically applicable for a single combination of parameters, including buffer distance. In a dynamic, real-time execution, a single <span class="math inline">\(\theta_{abort}\)</span> can actually lead to confusion and additional test team workload to determine, in the moment, whether this is the region or circumstance in which <span class="math inline">\(\theta_{abort}\)</span> applies and whether an “ABORT ABORT ABORT Angle” call is warranted. Multiple “zones” on the prepared surface increase the complexity of test conduct and can result in the very situations horizontal time safety margin is attempting to mitigate, namely abort calls that are too soon, and therefore a nuisance, or too late, and there for disastrous.</p>
<p>Test aids for visualizing the situation can assist, but themselves become safety-critical products that must be validated and version-controlled. Such aids could include:</p>
<ul>
<li>for a static <span class="math inline">\(\theta_{abort}\)</span>, regions of the prepared surface which are “free-movement”, “subject to <span class="math inline">\(\theta_{abort}\)</span>”, and “abort for proximity to edge”</li>
<li>a real-time (or faster-than-real-time) dynamically calculated <span class="math inline">\(\theta_{abort}\)</span> that is compared with the current angle with the edge of the prepared surface, for a given minimum time safety margin value</li>
</ul>
</section>
</section>
<section id="sec-consider_speed" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="sec-consider_speed"><span class="header-section-number">6.2</span> The Speed, <span class="math inline">\(s\)</span></h3>
<section id="sec-consider_speed_defn" class="level4" data-number="6.2.1">
<h4 data-number="6.2.1" class="anchored" data-anchor-id="sec-consider_speed_defn"><span class="header-section-number">6.2.1</span> Speed Definition</h4>
<p>The other component of the time safety margin worst-case, magnitude or speed, <span class="math inline">\(s\)</span>, is treated in this paper in a similar fashion as the angle, namely the speed at which the vehicle crosses the buffer line, with the same considerations of the worst-case vector direction.</p>
</section>
<section id="sec-consider_speed_accel" class="level4" data-number="6.2.2">
<h4 data-number="6.2.2" class="anchored" data-anchor-id="sec-consider_speed_accel"><span class="header-section-number">6.2.2</span> Linear Acceleration, <span class="math inline">\(\dot{s}\)</span></h4>
<p>Also similar to the angle, the simplifying assumptions treat the speed as constant throughout the time safety margin extension of the worst-case vector, as well as during the constant turn radius recovery maneuver. This is likely the largest deviation from actual execution, as thrust, aerodynamic drag, rolling friction, and use of energy management devices often result in speed changes.</p>
<p>Therefore, “constant speed” is the least likely assumption to hold, but it is also the assumption most likely to result in actual margins being greater than calculated. Simply by including any energy-decreasing actions as part of the abort procedure, the speed can be expected to be less than that used in the horizontal time safety margin calculation, resulting in:</p>
<ul>
<li>more time available</li>
<li>excess buffer distance</li>
<li>more angle available</li>
<li>excess turn radius</li>
</ul>
<p>Techniques such as “Throttle - IDLE” and “Brakes - APPLY” are fairly common in many ground maneuvering tests, both of which contribute to reducing the speed for some systems under certain conditions.</p>
<p>Conversely, any setup, test, or recovery techniques that could lead to acceleration and an increase in speed would result in insufficient margin.</p>
</section>
</section>
<section id="sec-consider_buffer" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="sec-consider_buffer"><span class="header-section-number">6.3</span> The Buffer Distance, <span class="math inline">\(b\)</span></h3>
<section id="sec-consider_buffer_defn" class="level4" data-number="6.3.1">
<h4 data-number="6.3.1" class="anchored" data-anchor-id="sec-consider_buffer_defn"><span class="header-section-number">6.3.1</span> Buffer Definition</h4>
<p>The buffer distance is the parameter most at the discretion of the test team. It is also the simplest: a distance, perpendicular to the edge of the prepared surface, forming a buffer line, beyond which testing will cease and a recovery maneuver will commence. The simple definition can mask the complexity of determining a useful buffer, and it may be advisable to have the buffer distance fall out of the equations as one of the last parameters whose values is set.</p>
</section>
<section id="sec-consider_buffer_veh_geom" class="level4" data-number="6.3.2">
<h4 data-number="6.3.2" class="anchored" data-anchor-id="sec-consider_buffer_veh_geom"><span class="header-section-number">6.3.2</span> Vehicle Geometry</h4>
<p>The example above treats the vehicle as a point mass, but vehicles will typically have 3 or more geometrically distributed points of contact with the ground. Additionally, vehicles typically have portions of their geometries that extend beyond the ground points of contact.</p>
<p>A main gear tire could end up off the prepared surface if track width, defined as the lateral extent of ground contacts, is not considered, even if the center of mass “recovers” at the edge of the prepared surface. It is recommended to take half of the track width as an additional offset in addition to the buffer distance to ensure all of the ground contact points remain on the prepared surface.</p>
<p>Likewise, the nose gear could leave the prepared surface if wheel base, defined as the longitudinal extent of ground contacts, is not considered. It is recommended that a ground track for the nosewheel be estimated to determine if additional offset is required for the test and recovery conditions. This initial treatment of horizontal time safety margin does not explore the conditions where nosewheel track becomes critical, but intuition suggests that for shallower crossing angles track width is more critical and for larger crossing angles wheel base is more critical.</p>
<p>Similar considerations apply for the full vehicle geometry beyond the extent of the ground points of contact, including nose, wings, and empennage, to mitigate collision with objects or personnel in the vertical dimension. Carefully survey test locations to account for three dimensional collisions. An example might be taxi testing in proximity to a hangar. Accounting for wheel base and track width will not be enough to avoid collision without sufficient three-dimensional margin.</p>
</section>
</section>
<section id="sec-consider_radius" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="sec-consider_radius"><span class="header-section-number">6.4</span> The Turn Radius, <span class="math inline">\(r\)</span></h3>
<section id="sec-consider_radius_defn" class="level4" data-number="6.4.1">
<h4 data-number="6.4.1" class="anchored" data-anchor-id="sec-consider_radius_defn"><span class="header-section-number">6.4.1</span> Turn Radius Definition</h4>
<p>Turn radius is the distance from the center of gravity to the instantaneous center of the turn circle. The assumption is that this radius is constant. This parameter is almost completely defined by vehicle geometry and kinematics, but dynamics can also influence the smallest acceptable turn radius.</p>
</section>
<section id="sec-consider_radius_geom" class="level4" data-number="6.4.2">
<h4 data-number="6.4.2" class="anchored" data-anchor-id="sec-consider_radius_geom"><span class="header-section-number">6.4.2</span> Geometry and Kinematics</h4>
<p>The geometry of ground contact points with respect to the vehicle center of mass, including wheel base fore and aft of the center of mass and the track width right and left of the center of mass, describes the kinematics of turning. Depending on the steering method for the vehicle, there is typically a kinematically determined minimum turn radius. For example, given nosewheel or tailwheel steering, there may be a maximum steering angle available, which would determine the minimum turn radius.</p>
</section>
<section id="sec-consider_radius_dynamics" class="level4" data-number="6.4.3">
<h4 data-number="6.4.3" class="anchored" data-anchor-id="sec-consider_radius_dynamics"><span class="header-section-number">6.4.3</span> Dynamics</h4>
<p>Turn radius is greatly affected by forces at the ground contact points and at aerodynamic control surfaces. The means of steering can have a significant effect both on the available turn radius and the constancy of the turn radius.</p>
<p>The primary means of directional control on the ground are:</p>
<ul>
<li>Nosewheel steering</li>
<li>Differential braking</li>
<li>Rudder effector (or equivalent)</li>
<li>Differential thrust (if available)</li>
</ul>
<p>The dynamics of each of these means vary greatly between systems, so knowledge of the system under test is essential for safe and effective safety planning and test conduct.</p>
<p>It is important to set aside time and provide resources for intentional development of test and recovery techniques for the system under test. Some techniques that work on one system may be “negative training” for another system. For example, if differential thrust is the most effective means of directional control, then “Throttle - IDLE” on all available engines or on the incorrect engine may result in disaster.</p>
</section>
</section>
<section id="sec-consider_time" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="sec-consider_time"><span class="header-section-number">6.5</span> The Time Margin, <span class="math inline">\(t\)</span></h3>
<section id="sec-consider_time_defn" class="level4" data-number="6.5.1">
<h4 data-number="6.5.1" class="anchored" data-anchor-id="sec-consider_time_defn"><span class="header-section-number">6.5.1</span> Time Margin Definition</h4>
<p>Time margin is well-described in <a href="#sec-tsm_origins" class="quarto-xref">Section&nbsp;2</a> and <a href="#sec-htsm_concept" class="quarto-xref">Section&nbsp;4</a>. The largest consideration of the definition is determining, for each test and recovery maneuver combination, the transition point out of the test manuever and into the recovery maneuver, then padding that transition with the time margin.</p>
</section>
<section id="sec-consider_time_duration" class="level4" data-number="6.5.2">
<h4 data-number="6.5.2" class="anchored" data-anchor-id="sec-consider_time_duration"><span class="header-section-number">6.5.2</span> Duration Selection</h4>
<p>A default of 4 seconds time margin for ground maneuvering, based on the work of Gray and the AGCAS team, is a solid starting point from which to deviate. Complexity or simplicity of the test maneuver, the recovery maneuver, and the transition between them can move the needle on time margin duration. Readiness of the test team can also affect the appropriate duration. The total available margin for test can also factor in. A very large surface with very simple maneuvers has inherently larger margins. A small surface with complex maneuvers has inherently smaller margins.</p>
<p>For scenarios with inherently smaller margins, the Air Force Test Center recommended mitigations for smaller time margin durations are a good practice, as shown in <a href="#tbl-afman_tsm" class="quarto-xref">Table&nbsp;1</a>.<span class="citation" data-cites="AFMAN11-2FTV3"><a href="#ref-AFMAN11-2FTV3" role="doc-biblioref">[3]</a></span></p>
<div id="tbl-afman_tsm" class="bordered quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-afman_tsm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Air Force Manual 11-2FTV3 TSM Risk Assessment
</figcaption>
<div aria-describedby="tbl-afman_tsm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-bordered caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Short Title</th>
<th>TSM Range [sec]</th>
<th>Minimum Planning Fidelity</th>
<th>Recovery Procedure</th>
<th>Minimum Training &amp; Buildup</th>
<th>Recovery Initiation Call</th>
<th>Baseline Post-Mitigation Risk Level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Routine</td>
<td><span class="math inline">\(t \ge 8\)</span></td>
<td>Normal ops</td>
<td>Routine</td>
<td>Not Required</td>
<td>Pilot</td>
<td>Low</td>
</tr>
<tr class="even">
<td>Focused</td>
<td><span class="math inline">\(8 &gt; t \ge 4\)</span></td>
<td>M&amp;S</td>
<td>Defined &amp; Documented</td>
<td>In-Flight Buildup</td>
<td>Pilot</td>
<td>Low</td>
</tr>
<tr class="odd">
<td>Aided</td>
<td><span class="math inline">\(4 &gt; t \ge 2.5\)</span></td>
<td>Best Available M&amp;S</td>
<td>Defined &amp; Documented</td>
<td>Sim Rehearsal &amp; In-Flight Buildup</td>
<td>Backup for Pilot</td>
<td>Low-Med</td>
</tr>
<tr class="even">
<td>Redundantly Aided</td>
<td><span class="math inline">\(2.5 &gt; t \ge 1.5\)</span></td>
<td>Best Available M&amp;S</td>
<td>Defined &amp; Documented</td>
<td>Sim Rehearsal &amp; In-Flight Buildup</td>
<td>Two Backups for Pilot &amp; Anticipatory Cueing Desired</td>
<td>Med-High</td>
</tr>
<tr class="odd">
<td>Cued Anticipation</td>
<td><span class="math inline">\(1.5 &gt; t \ge 0\)</span></td>
<td>Best Available M&amp;S</td>
<td>Defined &amp; Documented</td>
<td>Sim Rehearsal &amp; In-Flight Buildup</td>
<td>Two Backups for Pilot &amp; Anticipatory Cueing Required</td>
<td>High</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
<section id="sec-consider_interactions" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="sec-consider_interactions"><span class="header-section-number">6.6</span> Parameter Interactions</h3>
<p>The above considerations are primarily single-parameter, however, there are significant interactions between parameters.</p>
<section id="sec-consider_speed_radius" class="level4" data-number="6.6.1">
<h4 data-number="6.6.1" class="anchored" data-anchor-id="sec-consider_speed_radius"><span class="header-section-number">6.6.1</span> Speed and Turn Radius</h4>
<p>Speed and turn radius are roughly proportional, but specific relationships depend heavily on the system configuration and surface conditions. In general, the higher the speed, the larger the turn radius, and vice versa.</p>
<p>Skidding and slipping are primary factors in determining the relationship between speed and turn radius. In turns, the higher the speed the greater the lateral forces are exerted on ground contact points, which can lead to skids. Skidding can also occur due to brake torque increasing beyond rolling friction torque. Skidding is generally to be avoided, as it makes recovery highly unpredictable, increases turn radius, and can increase wear on tires.</p>
<p>Anti-skid braking systems can mitigate some skidding concerns when using brakes for energy management or for directional control. But reliance on anti-skid braking systems when planning for safety margin can result in sudden loss of margin if the anti-skid braking system is mis-tuned or malfunctions. Also, anti-skid braking systems can excite structural vibration modes that expose the system to other hazards. A conservative approach will assume no anti-skid braking system available, unless the system is very mature and other contingency maneuvers are planned.</p>
<p>Structural load limits are another factor that causes turn radius to increase with speed. Lateral loads are the source of the centripetal acceleration towards the inside of the turn circle. The smaller the radius and higher the speed, the larger the necessary force to keep the turn constant.</p>
<p>It is possible for some systems to have minimum allowable turn radius be a function of speed, which simplifies the modeling. In the absence of such explicit relationships, it’s important to realize that speed and turn radius are not independent, and to cross-check turn radius values with engineering judgement.</p>
</section>
<section id="sec-consider_interactions_buffer_radius_angle" class="level4" data-number="6.6.2">
<h4 data-number="6.6.2" class="anchored" data-anchor-id="sec-consider_interactions_buffer_radius_angle"><span class="header-section-number">6.6.2</span> Buffer Distance, Turn Radius, and Angle</h4>
<p>The interaction between buffer distance, turn radius, and angle is such that, the shallower the angle, the larger the maximum possible turn radius and the smaller the minimum possible buffer distance. As the angle approaches perpendicular to the buffer line and the edge, the buffer distance must be greater than the turn radius to allow for any time margin. Thus, the greater the crossing angle, the greater the buffer distance compared to the turn radius.</p>
</section>
<section id="sec-consider_interactions_speed_time_angle" class="level4" data-number="6.6.3">
<h4 data-number="6.6.3" class="anchored" data-anchor-id="sec-consider_interactions_speed_time_angle"><span class="header-section-number">6.6.3</span> Speed, Time Margin, and Angle</h4>
<p>The speed and time margin combine to become the distance margin available. The larger the distance margin, the smaller the angle available. Time margin should only be decreased for solid technical reasons to meet high-value test objectives. Thus, the distance margin will typically be primarily a result of speed, and test teams can expect to have smaller abort angles at higher speeds.</p>
</section>
</section>
<section id="beyond-horizontal-time-safety-margin" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="beyond-horizontal-time-safety-margin"><span class="header-section-number">6.7</span> Beyond Horizontal Time Safety Margin</h3>
<section id="test-technique-and-test-condition-selection" class="level4" data-number="6.7.1">
<h4 data-number="6.7.1" class="anchored" data-anchor-id="test-technique-and-test-condition-selection"><span class="header-section-number">6.7.1</span> Test Technique and Test Condition Selection</h4>
<p>The best test point is the test point that doesn’t need to be executed. Live test with full-scale assets is expensive in many ways, and exposing the test team, the system under test, and the people and property in the vicinity of the test to the risks inherent in test operations should be done with intention and with clear purpose. The next best test point is the test point that is executed in a manner tailored to the system and its environment, not one transferred from another system and another context without customization. Horizontal time safety margin is a method for planning and applying safety constraints to a test maneuver, but careful thought should be applied to whether the test maneuver should be included in the test campaign at all.</p>
</section>
<section id="longitudinal-time-safety-margin" class="level4" data-number="6.7.2">
<h4 data-number="6.7.2" class="anchored" data-anchor-id="longitudinal-time-safety-margin"><span class="header-section-number">6.7.2</span> “Longitudinal” Time Safety Margin?</h4>
<p>The horizontal time safety margin developed here could be called “lateral or yaw time safety margin,” as it only is concerned with recovery at the edge of the prepared surface parallel to the centerline. The margin required to avoid departing the end of the prepared surface in the longitudinal direction is not considered here. Contingencies in the case of loss of energy management devices (brakes, anti-skid systems, aerodynamic braking, etc) need to be considered, as well.</p>
</section>
<section id="consequences-of-experiencing-the-hazard" class="level4" data-number="6.7.3">
<h4 data-number="6.7.3" class="anchored" data-anchor-id="consequences-of-experiencing-the-hazard"><span class="header-section-number">6.7.3</span> Consequences of Experiencing the Hazard</h4>
<p>Not all test limits are created equal. The transition between the prepared surface and the surrounding environment relates directly to the urgency and intensity of abort calls and procedures. A painted line on a dry lakebed is not the same as a literal cliff adjacent to the prepared surface, for example. Adjust test procedures and conduct to reflect the severity of consequences should the hazard be encountered.</p>
</section>
</section>
</section>
<section id="sec-results" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="sec-results"><span class="header-section-number">7</span> Results During A Taxi Test Campaign</h2>
<p>The first applications of horizontal time safety margin were implemented during low-speed taxi. Low-speed was defined as the speed region in which aerodynamics had negligible contributions to directional control or vertical forces. Initial testing was conducted prior to the development of horizontal time safety margin. The first low-speed taxi runs were executed on ramp spaces to avoid interfering with daily general aviation operations. Buffer distances were established on the ramp spaces and object collision was a higher hazard than departure from the prepared surface. Once basic maneuverability and speed control was confirmed, low-speed testing proceeded to fairly narrow taxiways, approximately three to four times the track width. Taxiway buffer distances were established as a function of track width and desired distance from centerline. Angle offsets from centerline were small and speeds were low enough that any brake application promptly stopped the aircraft.</p>
<p>Low- and medium-speed taxi then progressed to runways. Medium-speed was defined as the speed region in which the rudder had sufficient control authority to be used for directional control but the wings did not produce enough lift for unintentional liftoff and the elevator did not have sufficient control authority to raise the nose gear off the ground. Nosewheel steering was disabled during the transition from low- to medium-speed taxi. Runway testing was the context in which horizontal time safety margin was conceived. Test techniques included intentional changes of heading to assess directional control margins. A previous test campaign had put off directional control evaluations until straight-line acceleration and braking were explored, but objectionable directional control handling was discovered during contingency operations, which is not the time to be discovering directional control issues. Therefore, for this campaign, directional control was explored early.</p>
<p>As the test team discussed appropriate abort criteria, the insufficiency of buffer distance alone became apparent as larger heading offsets were considered. As horizontal time safety margin was being initially implements, buffer distances were held constant and abort angles were calculated for each target test speed. At the time, the closed form solution of <a href="#eq-theta-full" class="quarto-xref">Equation&nbsp;5</a> had not been derived, so a brute force spreadsheet optimization technique was used for the calculations. Some basic assumptions about nosewheel skidding allowed for a relationship between speed and minimum turn radius, so the minimum turn radius became a function of speed and was not included separately.</p>
<p>For slower speeds, abort angle is very sensitive to changes in speed, which meant keeping up with a large number of abort criteria for a given set of test conditions. The complexity of updating abort angles for each test condition became a distraction during test conduct. As speeds increased, the calculated abort angles decreased less for each increment that speed increased as the angle became less sensitive to speed at higher speeds. The test team noticed that, since abort angles consistently decreased with increasing speeds, an abort angle for a given speed was conservative for all slower speeds. A “tiered” set of abort angles was developed, making use of the change in sensitivity and the fact that any abort angle at a given speed “covered” slower speeds. A table of two tiers was developed, based on speed values rounded up to the nearest 5 or 10 knot increment, such that a “low-medium speed” abort angle and a “high speed” abort angle for a given test location sufficed.</p>
<p>At higher speeds, the abort angle reduced to small values, three to five degrees, emphasizing to the test team that large directional control inputs at higher speeds was cause for an abort, even before a heading change developed. This was certainly the intuition of the test team already after significant prior education, training, and experience, but horizontal time safety margin provided a physical foundation for that intuition, along with a tangible and calculable constraint based on that foundation.</p>
</section>
<section id="sec-conclusions" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="sec-conclusions"><span class="header-section-number">8</span> Conclusions</h2>
<p>Horizontal time safety margin provides a quantitative basis for safety planning and test conduct of ground maneuvering test and recovery techniques. With a few simplifying assumptions, a reasonable estimate for buffer distances and abort angle criteria can be calculated for a system under test executing a test technique under a test condition on a given prepared surface. Horizontal time safety margin is appropriate for ramp, taxiway, and runway testing from low- through high-speed taxi testing.</p>
<p>The desired outcome of this paper and the accompanying presentation is to solicit feedback on the approach and to increase fidelity where appropriate. Additional considerations not covered here may surface during implementation in other contexts.</p>
</section>
<section id="sec-ack" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-ack">Acknowledgments</h2>
<ul>
<li>William “Evil” ‘Bill’ Gray for not only the original contributions to the subject, but the thorough documentation of the context and discussion surrounding diving time safety margin.</li>
<li>Jackson Cook for providing a return on the investment into his undergraduate math degree, resulting in a closed-form solution for determining <span class="math inline">\(\theta\)</span> based on a re-imagining of the trigonometry involved, which had eluded his father for more than a year. <a href="#fig-angles" class="quarto-xref">Figure&nbsp;5</a> is his direct contribution, without which this paper would have suffered greatly.</li>
<li>Michael “Ramjet” ‘Mick’ Mansfield for supporting this extension of prior practice into a new domain while under intense pressure to perform on a clean-sheet aircraft design.</li>
<li>The test pilots who put horizontal time safety margin through its paces: Kris “WigB” Rorberg, Tom “Sally” Fields, Jeremy “NOVA” Vanderhal, Brett “Pugs” Pugsley, and David “Pimp” ‘Kees’ Allamondola.</li>
<li>Madeleine “Mad” Graham, Mark “SCIPR” Jones, Tom “Sulu” Hill, NOVA, and Pimp for their insightful feedback.</li>
</ul>
</section>
<section id="sec-ref" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-ref">References</h2>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-Gray2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">W. R. Gray, <span>“Time Safety Margin: Theory And Practice.”</span> Sep. 2016. Available: <a href="https://apps.dtic.mil/sti/citations/AD1020034">https://apps.dtic.mil/sti/citations/AD1020034</a></div>
</div>
<div id="ref-AirplanePNG" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline"><span>“Airplane Top View PNGs by Vecteezy.”</span> Available: <a href="https://www.vecteezy.com/free-png/airplane-top-view">https://www.vecteezy.com/free-png/airplane-top-view</a></div>
</div>
<div id="ref-AFMAN11-2FTV3" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline"><span>“Flight Test Operations Procedures.”</span> Dec. 29, 2020. Available: <a href="https://static.e-publishing.af.mil/production/1/af_a3/publication/afman11-2ftv3/afman11-2ftv3.pdf">https://static.e-publishing.af.mil/production/1/af_a3/publication/afman11-2ftv3/afman11-2ftv3.pdf</a></div>
</div>
</div>
</section>
<section id="sec-bio" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-bio">Biography</h2>
<p><strong>Nathan “CAP’N” Cook</strong>, SFTE Fellow and a United States Air Force civil servant test engineer for 21 years, entered the startup world in 2023, first as Principal Flight Test Engineer and Test Conductor during Hermeus Quarterhorse Mk0 and Mk1 Taxi Test, and now as Principal Flight Test Engineer at EpiSci testing sUAS collaborative autonomy mesh networks and Group 5 flight and mission autonomy.</p>
<p><strong>Jackson Cook</strong> graduated from the University of Florida in December 2024 with a Bachelor’s of Science in Mathematics and a minor in Chinese. Topics of interest for him include algebra, topology, and combinatorics. Currently, Jackson works as an educator at a science center, tutors math, and does freelance video editing. He is also collaborating in a project studying algebraic structures, such as monoids, internal to graphs.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="sec-python" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-python">Appendix A - Python Implementation</h2>
<p><a href="#eq-theta-full" class="quarto-xref">Equation&nbsp;5</a>, <a href="#eq-time" class="quarto-xref">Equation&nbsp;9</a>, <a href="#eq-speed" class="quarto-xref">Equation&nbsp;10</a>, <a href="#eq-buffer" class="quarto-xref">Equation&nbsp;11</a>, and <a href="#eq-radius" class="quarto-xref">Equation&nbsp;12</a> can be implemented in Python using the <code>numpy</code> package for the trigonometric functions <code>arcsin</code>, <code>arctan</code>, and <code>sqrt</code>. These functions are defined with arbitrary default values of buffer distance, <code>buffer</code>, recovery turn radius, <code>radius</code>, speed, <code>speed</code>, and time safety margin duration, <code>time</code>. These default values allow the functions to return a value in the absence of one or more input argument definitions.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> sin, cos, arcsin, arctan, sqrt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> abort_angle(<span class="bu">buffer</span><span class="op">=</span><span class="fl">4.0</span>, radius<span class="op">=</span><span class="fl">1.0</span>, speed<span class="op">=</span><span class="fl">1.0</span>, time<span class="op">=</span><span class="fl">4.0</span>):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        arctan(radius <span class="op">/</span> (time <span class="op">*</span> speed))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> arcsin((<span class="bu">buffer</span> <span class="op">-</span> radius) <span class="op">/</span> sqrt(radius<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (time <span class="op">*</span> speed) <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> abort_buffer(angle<span class="op">=</span>abort_angle(), radius<span class="op">=</span><span class="fl">1.0</span>, speed<span class="op">=</span><span class="fl">1.0</span>, time<span class="op">=</span><span class="fl">4.0</span>):</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(time <span class="op">*</span> speed <span class="op">*</span> sin(angle) <span class="op">+</span> radius <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> cos(angle)))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> time_margin(<span class="bu">buffer</span><span class="op">=</span><span class="fl">4.0</span>, radius<span class="op">=</span><span class="fl">1.0</span>, speed<span class="op">=</span><span class="fl">1.0</span>, angle<span class="op">=</span>abort_angle()):</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">buffer</span> <span class="op">+</span> radius <span class="op">*</span> (cos(angle) <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span> (speed <span class="op">*</span> sin(angle))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> abort_speed(<span class="bu">buffer</span><span class="op">=</span><span class="fl">4.0</span>, radius<span class="op">=</span><span class="fl">1.0</span>, angle<span class="op">=</span>abort_angle(), time<span class="op">=</span><span class="fl">4.0</span>):</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">buffer</span> <span class="op">+</span> radius <span class="op">*</span> (cos(angle) <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span> (time <span class="op">*</span> sin(angle))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> abort_radius(<span class="bu">buffer</span><span class="op">=</span><span class="fl">4.0</span>, angle<span class="op">=</span>abort_angle(), speed<span class="op">=</span><span class="fl">1.0</span>, time<span class="op">=</span><span class="fl">4.0</span>):</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">float</span>((time <span class="op">*</span> speed <span class="op">*</span> sin(angle) <span class="op">-</span> <span class="bu">buffer</span>) <span class="op">/</span> (cos(angle) <span class="op">-</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The fact that <span class="math inline">\(\theta\)</span> appears twice in this equation within trigonometric functions is what prevents this equation from being used to solve for <span class="math inline">\(\theta\)</span>, thus the derivation in <a href="#sec-calc_theta" class="quarto-xref">Section&nbsp;5.1</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>